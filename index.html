<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Cigarette Consumption</title>
    
    <!--Bootstrap Style Sheet and Javascript-->
    <link href="dist/css/bootstrap.css" rel="stylesheet">
   
    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="js/highcharts.js"></script>
    <script src="js/exporting.js"></script>
    <!--Bootstrap Javascript-->
    <script src="js/bootstrap.js"></script>
    <!--For my Map-->
    <script src="js/ammap.js" type="text/javascript"></script>
    <script src="ammap/maps/js/worldLow.js" type="text/javascript"></script>
    
    <script type="text/javascript">
	console.log("page load");
	var DailyCigarette = [];
	var Year2 = [];
	var Age1 = [];
	var Age2 =[];
	var Age3 = [];
	var Age4 = [];
	var Age5 = [];
        
                        var Year = [];
                        var SmokingPercent = [];
                        var CigaretteConsumption = [];
                        var buildHTML;
        
        $(document).ready(function(){
            console.log("doc ready");
			$.ajax({
				type: "GET",
				url: "Total.xml",
				dataType: "xml",
				success: function(xml) {
                                    console.log("xml success");
                                    
                                    $(xml).find('CigaretteConsumption').each(function(){
                                        console.log("found cigs");
                                                
                                                var $CigaretteConsumption = $(this);
						/*$(this).find('CigaretteConsumption').each(function(){*/
                                                Year.push(parseInt($CigaretteConsumption.find('Year').text()))
                                                /*Year.push(parseInt($(this).find('Year').text())*/
                                                SmokingPercent.push(parseInt($CigaretteConsumption.find('SmokingPercent').text()))
                                                
						/*console.log(SmokingPercent);
                                                console.log(Year);*/
						
					/*}); //(this)CigaretteConsumption*/
					}); //CigaretteConsumption
					
					parsexml2();
				} //success function
    
		
		           });//ajax for line graph
                        
          }); //documentready
			function parsexml2(){
			    console.log("parsexml2");
                         $.ajax({
				type: "GET",
				url: "ByAge.xml",
				dataType: "xml",
				success: function(xml) {
                                    console.log("xml success 2");
                                    
                                    $(xml).find('DailyCigarette').each(function(){
                                        console.log("found daily");
				    var $DailyCigarette = $(this);
				    Year2.push(parseInt($DailyCigarette.find('Year2').text()))
				    Age1.push(parseInt($DailyCigarette.find('Age1').text()))
				    Age2.push(parseInt($DailyCigarette.find('Age2').text()))
				    Age3.push(parseInt($DailyCigarette.find('Age3').text()))
				    Age4.push(parseInt($DailyCigarette.find('Age4').text()))
				    Age5.push(parseInt($DailyCigarette.find('Age5').text()))
				    
                                        
                                    });//end dailycigarette
                                    
                                    
                                    writeChart();
                                    
                                }//success2
                                    
		           });//close ajax
                         
			};//closeparsexml
                                    
                                    
    
    
    
function writeChart () {
        
        $('#chart1').highcharts({
            title: {
                text: 'Cigarette Consumption in the U.S.A',
                x: -20 //center
            },
            subtitle: {
                text: 'Mouse over to see percent of adults smoking each year',
                x: -20
            },
            xAxis: {
		tickInterval: 3,
                categories: Year,
                title: {
                    text: 'Year'
                }
            },
            yAxis: {
		min: 0,
		max: 45,
                categories: null,
                title: {
                    text: 'Percent of Adults'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
            tooltip: {
                valueSuffix: '%'
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle',
                borderWidth: 0
            },
            series: [{
                name: 'U.S.A',
                data: SmokingPercent
            }]//ends series
        });//ends chart1
        
        
        $('#chart2').highcharts({
    
            chart: {
                type: 'column'
            },
    
            title: {
                text: 'Percent of Daily Smokers by Age'
            },
    
            xAxis: {
                categories: Year2,
                title: {
                    text: 'Year'
                }
            },
    
            yAxis: {
                allowDecimals: false,
                min: 0,
		max: 21, 
                title: {
                    text: 'Percent who smoke daily'
                }
            },
    
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0
                }
            },
    
            series: [{
                name: '12-17 years old',
                data: Age1,
            }, {
                name: '18-25 years old',
                data: Age2,
            }, {
                name: '26-34 years old',
                data: Age3,
            }, {
                name: '35-49 years old',
                data: Age4,
	    },
	       {
		name: '50+ years old',
		data: Age5,
            }]//ends series
        });//ends Chart2
        
}//ends writeChart
                                    
        //For My map
	AmCharts.ready(function() {
        // create AmMap object
        var map = new AmCharts.AmMap();
        // set path to images
        map.pathToImages = "ammap/images/";
	
	var dataProvider = {
            mapVar: AmCharts.maps.worldLow,
            areas: [{id:"AU", color:"#CC0000"},{id:"US", color:"#00CC00"},{id:"FR", color:"#0000CC"}]                 
        }; 
	
	 map.dataProvider = dataProvider;
	
	map.areasSettings = {
            autoZoom: true,
            selectedColor: "#CC0000"
        };
	
	 map.write("mapdiv");               
        
    });
    
                                    
                                    
    </script> 
    
    
</head>

<body>

    
<div id="chart1" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
<div id="chart2" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
<div id="mapdiv" style="min-width: 310px; height: 400px;"></div>


</body>
</html>
